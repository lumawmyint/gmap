<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ameriprise Back-Office Management System</title>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <style>
        :root {
            --bg-dark: #b3e4e4;
            --bg-darker: #08162e;
            --bg-panel: #24282e;
            --bg-panel-light: #2d3239;
            --text-primary: #e1e7ec;
            --text-secondary: #b8c2cc;
            --accent-blue: #d5f3de;
            --accent-blue-dark: #3a7bc8;
            --border-dark: #343a42;
            --border-light: #3e444d;
            --alert-warning: rgba(255, 230, 0, 0.185);
            --alert-warning-border: #ffc107;
            --table-header: #2d3239;
            --table-row: #2a2f36;
            --button-primary: #4d9ef7;
            --button-hover: #3a7bc8;
            --button-active: #2a5d9c;
            --input-bg: #2d3239;
            --input-border: #3e444d;
            --input-focus: rgba(77, 158, 247, 0.2);
        }

        /* Base Styles */
        body {
            font-family: 'Segoe UI', system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--bg-dark);
            color: var(--text-primary);
            line-height: 1.5;
            font-size: 14px;
        }

        /* Main Container */
        .container {
            max-width: 1400px;
            margin: 20px auto;
            background-color: var(--bg-panel);
            border-radius: 6px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        /* Header Section */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 14px 24px;
            background-color: var(--bg-darker);
            border-bottom: 1px solid var(--border-dark);
        }

        .header h1 {
            margin: 0;
            font-size: 18px;
            font-weight: 500;
            letter-spacing: 0.3px;
            color: var(--text-primary);
        }

        .timestamp {
            font-size: 16px;
            color: rgb(152, 209, 87);
            font-family: 'Roboto Mono', monospace;
            letter-spacing: 0.5px;
        }

        /* Welcome Message */
        .welcome-message {
            /*padding: 14px 24px; */
            font-size: 16px;
            /*background-color: var(--bg-panel-light);*/
            /*/border-bottom: 1px solid var(--border-dark); */
            color: var(--text-primary);
            font-weight: 500;
        }

        /* Navigation Tables */
        .nav-table {
            width: 100%;
            border-collapse: collapse;
            margin: 0;
            font-size: 13px;
        }

        .nav-table td {
            padding: 12px 16px;
            border: 1px solid var(--border-dark);
            text-align: center;
            transition: all 0.15s ease;
            position: relative;
        }

        .nav-table tr:first-child td {
            background-color: var(--bg-darker);
            font-weight: 600;
            color: var(--accent-blue);
            border-bottom: 1px solid var(--border-dark);
        }

        .nav-table td:hover {
            background-color: rgba(77, 158, 247, 0.08);
            cursor: pointer;
        }

        .nav-table td:active {
            background-color: rgba(77, 158, 247, 0.15);
        }

        /* Alert Box */
        .alert-box {
            margin: 20px 24px;
            padding: 16px 20px;
            background-color: var(--alert-warning);
            border-left: 4px solid var(--alert-warning-border);
            border-radius: 0 4px 4px 0;
        }

        .alert-title {
            font-weight: 600;
            margin-bottom: 12px;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            font-size: 15px;
        }

        .alert-title:before {
            content: "‚ö†";
            margin-right: 10px;
            font-size: 16px;
        }

        .alert-content {
            padding-left: 26px;
            color: var(--text-secondary);
            font-size: 16px;
        }

        .alert-content ul {
            margin: 12px 0;
            padding-left: 20px;
        }

        .alert-content li {
            margin-bottom: 10px;
            line-height: 1.6;
        }

        .alert-content em {
            font-style: italic;
            color: var(--text-primary);
        }

        /* Info Table */
        .info-table {
            width: calc(100% - 48px);
            margin: 24px;
            border-collapse: collapse;
            border: 1px solid var(--border-dark);
        }

        .info-table th {
            background-color: var(--table-header);
            padding: 14px 16px;
            text-align: left;
            font-weight: 600;
            color: var(--accent-blue);
            border-bottom: 2px solid var(--border-dark);
            font-size: 13.5px;
        }

        .info-table td {
            padding: 16px;
            border-bottom: 1px solid var(--border-dark);
            vertical-align: top;
            background-color: var(--table-row);
            color: var(--text-secondary);
        }

        .info-table tr:last-child td {
            border-bottom: none;
        }

        .info-table ul {
            margin: 0;
            padding-left: 20px;
        }

        .info-table li {
            margin-bottom: 8px;
        }

        /* Interactive Elements */
        .editable-email {
            color: var(--accent-blue);
            cursor: pointer;
            transition: all 0.2s ease;
            font-weight: 500;
            font-size: 17px;
            position: relative;
        }

        .editable-email:hover {
            color: var(--button-hover);
            text-decoration: underline;
        }

        .editable-email:after {
            content: "‚úÖ";
            margin-left: 6px;
            font-size: 12px;
            opacity: 0.7;
        }

        .button {
            background-color: var(--button-primary);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            font-size: 12.5px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-weight: 500;
            letter-spacing: 0.3px;
        }

        .button:hover {
            background-color: var(--button-hover);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        }

        .button:active {
            background-color: var(--button-active);
            transform: translateY(1px);
        }

        /* Form Elements */
        #email-edit {
            display: flex;
            gap: 10px;
            align-items: center;
            padding: 12px 24px;
            background-color: var(--bg-panel-light);
            border-top: 1px solid var(--border-dark);
        }

        #email-input {
            flex-grow: 1;
            padding: 9px 14px;
            border: 1px solid var(--border-dark);
            border-radius: 4px;
            font-size: 13.5px;
            background-color: var(--bg-panel);
            color: var(--text-primary);
            outline: none;
        }

        #email-input:focus {
            border-color: var(--accent-blue);
            box-shadow: 0 0 0 2px rgba(77, 158, 247, 0.2);
        }

        /* Improved Credit Score Form */
        .credit-score-form {
            width: 100%;
            max-width: 830px;
            margin: 24px auto;
            padding: 28px 32px;
            background-color: var(--bg-panel-light);
            border-radius: 8px;
            border: 1px solid var(--border-dark);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
            transition: box-shadow 0.3s ease;
        }

        .credit-score-form:hover {
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: var(--text-primary);
        }

        .form-control {
            width: 20%;
            padding: 8px 12px;
            background-color: var(--input-bg);
            border: 1px solid var(--input-border);
            border-radius: 4px;
            color: var(--text-primary);
            font-size: 14px;
        }

        .form-control:focus {
            border-color: var(--accent-blue);
            outline: none;
            box-shadow: 0 0 0 2px var(--input-focus);
        }

        .form-row {
            display: flex;
            gap: 15px;
        }

        .form-col {
            flex: 1;
        }

        .result-box {
            margin-top: 20px;
            padding: 15px;
            background-color: rgba(77, 158, 247, 0.1);
            border-left: 4px solid var(--accent-blue);
            border-radius: 0 4px 4px 0;
        }

        .result-value {
            font-weight: 600;
            color: var(--accent-blue);
        }

        /* Utility Classes */
        .hidden {
            display: none;
        }

        /* Divider */
        hr {
            border: 0;
            height: 1px;
            background-color: var(--border-dark);
            margin: 20px 0;
        }

        /* Specific styling for the credit score info cell */
        .credit-score-info {
            width: 60%; /* Adjust percentage as needed */
            max-width: 500px; /* Optional maximum width */
            min-width: 300px; /* Optional minimum width */
        }

        #current-score, #payment-amount, #payment-amount, #points-lost, #per-point-value, #color, #payment-amount-2 {
            color: #e2ce1ade;              /* Amber/orange color for warning */
            font-weight: 600;
            font-size: large;
            font-family: 'Roboto Mono', monospace; /* Monospace for numbers */                         
        }

        .screenshot-button {
            /*display: block; */
            margin: 15px auto;
            padding: 10px 20px;
            font-size: 16px;
            font-family: 'Segoe UI', sans-serif;
            background-color: #7256b3;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }

        /* New styles for the document section */
        .document-container {
            max-width: 800px;
            margin: 30px auto;
            padding: 30px;
            background-color: white;
            color: #333;
            border-radius: 4px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            font-family: Arial, sans-serif;
            line-height: 1.6;
            font-size: 21px;
        }
        
        .document-header {
            text-align: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
        }

        .header {
            text-align: center;
        }
        
        .document-title {
            font-size: 24px;
            font-weight: bold;
            text-align: center;
            margin-bottom: 10px;
            color: #2c3e50;
        }
        
        .document-subtitle {
            font-size: 25px;
            text-align: center;
            margin-bottom: 30px;
            color: #2c8ecf;
            /*border-bottom: 1px solid #ecf0f1;*/
            padding-bottom: 15px;
        }
        
        .document-content {
            line-height: 1.6;
        }
        
        .document-section {
            margin-bottom: 20px;
        }
        
        .document-section-title {
            font-weight: bold;
            margin: 15px 0 10px 0;
            font-size: 16px;
            color: #2c3e50;
        }
        
        .document-highlight {
            font-weight: bold;
            color: #e74c3c;
        }

        .document-list {
            margin: 10px 0;
            padding-left: 20px;
        }

        .document-divider {
            border-top: 1px dashed #bdc3c7;
            margin: 25px 0;
        }

        .document-footer {
            font-style: italic;
            margin-top: 30px;
            padding-top: 15px;
            border-top: 1px solid #ecf0f1;
            color: #7f8c8d;
        }
        
        .document-note {
            font-style: italic;
            margin-top: 30px;
            padding-top: 10px;
            border-top: 1px solid #eee;
        }
        
        .document-capture-container {
            text-align: center;
            margin-top: 20px;
        }

        /* Calculator section styles */
        .calculator-section {
            background-color: #5e758d;
            padding: 20px;
            border-radius: 5px;
            margin-bottom: 30px;
            border: 1px solid #dee2e6;
        }
        
        .calculator-title {
            font-size: 20px;
            margin-bottom: 15px;
            color: #2c3e50;
        }
        
        .calculator-result {
            background-color: #1f4242;
            padding: 15px;
            border-radius: 5px;
            margin-top: 15px;
        }

        .docHeader {
            display: flex;
            justify-content: center; /* Centers horizontally */
            align-items: center;     /* Centers vertically */
            text-align: center;      /* Additional centering for text elements */
            padding: 10px 0;        /* Adds some space around */
        }

        .logo {
            max-width: 430px;       /* Adjust this value to your preferred size */
            height: auto;           /* Maintains aspect ratio */
            display: block;         /* Ensures proper spacing */
        }

        #minimum-score-group {
            display: none;
        }

        #a4-document {
            background-color: #ffffff !important;
            color: #000 !important; /* optional: in case text is light-colored */
        }

        .signature-container {
            margin-top: -5px;
            text-align: right;
        }
        
        .signature-text {
            font-style: italic;
            /*margin-top: 5px;*/
        }

        .signature-image {
            max-width: 300px;
            height: auto;
        }

        .date {
            text-align: right;
            margin-top: 10px;
            color: #7f8c8d;
            font-style: italic;
            font-weight: bold;
        }

        /* Responsive Adjustments */
        @media (max-width: 768px) {
            .container {
                margin: 0;
                border-radius: 0;
            }
        
            .nav-table td {
                padding: 10px 8px;
                font-size: 12px;
            }
            
            .alert-content {
                padding-left: 0;
            }
            
            .form-row {
                flex-direction: column;
                gap: 10px;
            }
        }
    </style>
</head>
<body>

    <button class="screenshot-button" onclick="captureMain()">üì∏ Capture SS </button>
    <div id="notification" style="display: none; position: fixed; top: 20px; right: 20px; background: #3f47b4; color: white; padding: 15px; border-radius: 5px; z-index: 1000;">
        Image copied to clipboard!
    </div>
    <div class="container">
        <div class="header">
            <div class="welcome-message">Welcome to the Ameriprise back-office management system</div>
            <div class="timestamp" id="timestamp"></div>
        </div>       
        
        
        <table class="nav-table">
            <tr>
                <td>UFL Overview</td>
                <td>CIR</td>
                <td>OPM</td>
                <td>M M</td>
            </tr>
        </table>
        
        <table class="nav-table">
            <tr>
                <td>UFL Overview</td>
                <td>‚óã</td>
                <td id="user-email" class="editable-email">salmantanveer494@gmail.com</td>
                <td><button class="button">Reset</button></td>
                <td>ETE</td>
                <td>Is Admin</td>
                <td>Is ML</td>
                <td>Is Guest</td>
            </tr>
        </table>
        
        <table class="nav-table">
            <tr>
                <td>Member Info</td>
                <td>WDR</td>
                <td>Deposit</td>
                <td>GRec</td>
                <td>BCLink</td>
                <td>UVQuery</td>
                <td>CSing</td>
                <td>LIPI</td>
                <td>BPIC</td>
                <td>Noble Records</td>
                <td>MVConfig</td>
            </tr>
        </table>
        
        <hr>
        
        <h2 style="margin: 0 24px;">SYSTEM MESSAGE</h2>
        
        <div class="alert-box">
            <div class="alert-title">Dear Ameriprise user : <span id="display-email"> abcd1234@gmail.com</span></div>
            <div class="alert-content">
                <ul>
                    <li>During one of the task operations the system detected an error, resulting in a drop in your credit score from <span id='color'>100</span> to <span id="current-score">90</span>. To proceed with your withdrawal, please restore your credit score by paying ‚Çπ<span id="payment-amount">150,000</span> (<span id="points-lost">10</span> Points √ó ‚Çπ<span id="per-point-value">15,000</span>).</li>
                    <li>After restoring the credit score <span id='color'>to 100</span>, customer service will assist you with the withdrawal of funds to your bank account.</li>
                    <li>This deduction serves as a warning. Once the payment of ‚Çπ<span id="payment-amount-2">150,000</span> is completed, customer service will be able to assist you with the withdrawal of your funds to the bank account                         </em></li>
                </ul>
            </div>
        </div>       
        
        
        <table class="info-table">
            <tr>
                <th>CSE</th>
                <th>CSA</th>
                <th>CSV</th>
            </tr>
            <tr>
                <td class="credit-score-info">Credit score is based on all aspects of the data and design of the credit system, in essence, "credit score" is a set of credit systems, the platform's behavioural records. The comprehensive processing and evaluation of massive information data may include: five dimensional user credit history, behavioural preferences, performance ability, identity traits, and personal connections. Based on Internet financial data and data cooperation with public institutions such as the public security network and partners, which is different from traditional credit data. <em>By analysing a large amount of online transaction and behavioural data, Credit Score can help Internet financial enterprises to provide users with quick credit and cash instalment services.</em></td>
                <td>
                    <ul>
                        <li>Widespread Named Users</li>
                        <li>Unique Data Value</li>
                        <li>Powerful Data Capability</li>
                        <li>Convenient Scenario Application</li>
                    </ul>
                </td>
                <td>
                    <ul>
                        <li>CSRNC</li>
                        <li>CEE</li>
                        <li>I+C</li>
                        <li>PF</li>
                        <li>BCC</li>
                    </ul>
                </td>
            </tr>
        </table>

        
    </div>

    <div class="credit-score-form">
            <h3 style="margin-top: 0;">Credit Score Configuration and Email</h3>
            
            <!-- Add these new form fields -->
            <div class="form-row">
                <div class="form-col">
                    <div class="form-group">
                        <label for="original-score-input">Original Credit Score</label>
                        <input type="number" id="original-score-input" class="form-control" value="100" readonly>
                    </div>
                </div>
                <div class="form-col">
                    <div class="form-group">
                        <label for="current-score-input">Current Credit Score</label>
                        <input type="number" id="current-score-input" class="form-control" value="95" min="1" max="1000">
                    </div>
                </div>
            </div>
            
            <div class="form-group">
                <label for="base-withdrawable">Wallet Balance (‚Çπ)</label>
                <input type="number" id="base-withdrawable" class="form-control" value="200000">
            </div>
            
            <div class="form-group" id="minimum-score-group">
                <label for="minimum-score">Minimum Required Score</label>
                <input type="number" id="minimum-score" class="form-control" value="100" min="1" readonly>
            </div>
            
            <div class="form-group">
                <label for="per-point-cost">Amount per point (‚Çπ)</label>
                <input type="number" id="per-point-cost" class="form-control" value="10000" min="1">
            </div>
            
            <button id="calculate-btn" class="button">Calculate Payment</button>
            
            <div id="calculation-result" class="result-box">
                <h4 style="margin-top: 0;">Calculation Result</h4>
                <p>Points to restore: <span id="calculated-points">50</span></p>
                <p>Amount per point: ‚Çπ<span id="calculated-per-point">5,000</span></p>
                <p>Total payment required: ‚Çπ<span id="calculated-total">250,000</span></p>
            </div>
            
            <div id="email-edit" class="hidden">
                <input type="text" id="email-input" value="salmantanveer494@gmail.com">
                <button class="button" onclick="saveEmail()">Save</button>
                <button class="button" onclick="cancelEdit()">Cancel</button>
            </div>
            
            <!-- Add the Confidentiality Agreement Document -->
            <div class="document-container" id="a4-document">

                <div class="docHeader">
                    <img src="Ameriprise.jpg" alt="Ameriprise Logo" class="logo">
                </div>
                <h2 class="document-subtitle">Confidentiality Coverage Agreement</h2>                
          
                
                <p><strong>Subject:</strong> <span class="document-highlight">Action Required</span> - Credit Score Restoration for Withdrawal Eligibility</p>
                <p><strong>User Account:</strong> <span id="document-email">salmantanveer494@gmail.com</span></p>
                
                <div class="document-divider"></div>
                
                <h3>Current Status - Insufficient Credit Score !!!</h3>
                <p>Please be advised that due to discrepancies identified in previous transactions, your settlement system score has been adjusted to <span class="document-highlight" id="document-current-score">50</span> points. Please note that the platform requires a minimum score of <span class="document-highlight" id="document-min-score">100</span> points to facilitate normal settlement and withdrawal operations.</p>
                
                <p>
            As each credit point carries a value of ‚Çπ<span class="document-highlight" id="document-point-value">5,000</span>, 
            a deposit of ‚Çπ<span class="document-highlight" id="document-deposit">250,000</span> 
            (<span class="document-highlight" id="document-points-needed">50</span> points √ó ‚Çπ<span class="document-highlight" id="document-point-value-multiply">5,000</span>) 
            is required to restore your score to the mandatory threshold of <span class="document-highlight">100</span> points.
                </p>
                
                <ul>
                    <li><strong>Required Deposit Amount:</strong> ‚Çπ<span class="document-highlight" id="document-deposit-amount">250,000</span></li>
                    <li><strong>Required Deposit Amount:</strong> ‚Çπ<span class="document-highlight" id="document-base-amount">350,400</span> + ‚Çπ<span class="document-highlight" id="document-deposit-display">250,000</span> = ‚Çπ<span class="document-highlight" id="document-total-amount">600,400</span></li>
                </ul>
                
                <div class="signature-container">
                    <img src="signature.jpg" alt="Official Signature" class="signature-image">
                    <div class="signature-text">Ameriprise Venture Capital-Finance Department<br>Signed by the Branch Manager</div>
                    <div class="date" id="currentDate"></div>
                </div>
                <br>
                
                <p><em span class="document-highlight">Note:</em> <span class="document-highlight">Please complete the payment as soon as possible in the system within the stipulated time, to avoid unnecessary losses caused by overtime.</span></p>
            </div>
            
            <div class="document-capture-container">
                <button class="screenshot-button" onclick="captureDocument()">üì∏ Capture Document SS</button>
            </div>
    </div>
           

    <script>

        // Set current date
        const now = new Date();
        const options = { day: 'numeric', month: 'long', year: 'numeric' };
        document.getElementById('currentDate').textContent = now.toLocaleDateString('en-US', options);

        // Update timestamp with current date and time
        function updateTimestamp() {
            const now = new Date();
            const options = { 
                hour: '2-digit', 
                minute: '2-digit',
                hour12: false
            };
            const timeStr = now.toLocaleTimeString([], options);
            const dateStr = now.toLocaleDateString();
            document.getElementById('timestamp').textContent = `${timeStr} ${dateStr}`;
        }
        
        // Update timestamp immediately and then every minute
        updateTimestamp();
        setInterval(updateTimestamp, 60000);
        
        // Email editing functionality
        document.getElementById('user-email').addEventListener('click', function() {
            document.getElementById('email-edit').classList.remove('hidden');
            document.getElementById('user-email').classList.add('hidden');
        });
        
        function saveEmail() {
            const newEmail = document.getElementById('email-input').value;
            document.getElementById('user-email').textContent = newEmail;
            document.getElementById('display-email').textContent = newEmail;
            document.getElementById('email-edit').classList.add('hidden');
            document.getElementById('user-email').classList.remove('hidden');
        }
        
        function cancelEdit() {
            document.getElementById('email-edit').classList.add('hidden');
            document.getElementById('user-email').classList.remove('hidden');
        }
        
        // Credit score calculation functionality
        document.getElementById('calculate-btn').addEventListener('click', function() {
            const originalScore = parseInt(document.getElementById('original-score').value);
            const currentScore = parseInt(document.getElementById('current-score-input').value);
            const perPointCost = parseInt(document.getElementById('per-point-cost').value);
            
            if (isNaN(originalScore) || isNaN(currentScore) || isNaN(perPointCost)) {
                alert('Please enter valid numbers for all fields');
                return;
            }
            
            if (currentScore > originalScore) {
                alert('Current score cannot be higher than original score');
                return;
            }
            
            const pointsLost = originalScore - currentScore;
            const totalPayment = pointsLost * perPointCost;

            // --- ADD THESE 2 LINES HERE ---
            const baseWithdrawable = parseInt(document.getElementById('base-withdrawable').value);
            const minScore = parseInt(document.getElementById('minimum-score').value);
            
            // Update the calculation result box
            document.getElementById('calculated-points').textContent = pointsLost;
            document.getElementById('calculated-per-point').textContent = formatNumber(perPointCost);
            document.getElementById('calculated-total').textContent = formatNumber(totalPayment);
            document.getElementById('calculation-result').classList.remove('hidden');
            
            // Update the alert message
            document.getElementById('current-score').textContent = currentScore;
            document.getElementById('points-lost').textContent = pointsLost;
            document.getElementById('per-point-value').textContent = formatNumber(perPointCost);
            document.getElementById('payment-amount').textContent = formatNumber(totalPayment);
            document.getElementById('payment-amount-2').textContent = formatNumber(totalPayment);

            // --- ADD THESE DOCUMENT UPDATES HERE ---
            // Update Confidentiality Agreement document values
            document.getElementById('document-current-score').textContent = currentScore;
            document.getElementById('document-point-value').textContent = formatNumber(perPointCost);
            document.getElementById('document-points-needed').textContent = pointsLost;
            document.getElementById('document-deposit-amount').textContent = formatNumber(totalPayment);
            document.getElementById('document-total-withdrawable').textContent = formatNumber(totalPayment + baseWithdrawable);
            document.getElementById('document-minimum-score').textContent = minScore;
        });
        
        // Format number with commas
        function formatNumber(num) {
            return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        }

        // Update all values in both form and document
        function updateAllValues() {
            const originalScore = parseInt(document.getElementById('original-score-input').value);
            const currentScore = parseInt(document.getElementById('current-score-input').value);
            const baseAmount = parseInt(document.getElementById('base-withdrawable').value);
            const minScore = parseInt(document.getElementById('minimum-score').value);
            const perPointCost = parseInt(document.getElementById('per-point-cost').value);
            
            // Calculate values
            const pointsNeeded = minScore - currentScore;
            const totalPayment = pointsNeeded * perPointCost;
            const totalWithdrawable = baseAmount + totalPayment;
            
            // Update form results
            document.getElementById('document-point-value-multiply').textContent = formatNumber(perPointCost);
            document.getElementById('calculated-points').textContent = pointsNeeded;
            document.getElementById('calculated-per-point').textContent = formatNumber(perPointCost);
            document.getElementById('calculated-total').textContent = formatNumber(totalPayment);
            
            // Update alert message
            document.getElementById('current-score').textContent = currentScore;
            document.getElementById('points-lost').textContent = pointsNeeded;
            document.getElementById('per-point-value').textContent = formatNumber(perPointCost);
            document.getElementById('payment-amount').textContent = formatNumber(totalPayment);
            document.getElementById('payment-amount-2').textContent = formatNumber(totalPayment);
            
            // Update document - MAKE SURE TO UPDATE THE PARAGRAPH VALUE TOO
            document.getElementById('document-current-score').textContent = currentScore;
            document.getElementById('document-min-score').textContent = minScore;
            document.getElementById('document-point-value').textContent = formatNumber(perPointCost);
            document.getElementById('document-points-needed').textContent = pointsNeeded;
            document.getElementById('document-deposit').textContent = formatNumber(totalPayment);
            document.getElementById('document-deposit-amount').textContent = formatNumber(totalPayment);
            document.getElementById('document-base-amount').textContent = formatNumber(baseAmount);
            document.getElementById('document-deposit-display').textContent = formatNumber(totalPayment);
            document.getElementById('document-total-amount').textContent = formatNumber(totalWithdrawable);
            
            // Add this line to update the paragraph value after "points x"
            document.querySelector('#confidentiality-agreement p:nth-of-type(3)').innerHTML = 
                `As each credit point carries a value of ‚Çπ<span class="document-highlight">${formatNumber(perPointCost)}</span>, ` +
                `a deposit of ‚Çπ<span class="document-highlight">${formatNumber(totalPayment)}</span> ` +
                `(<span class="document-highlight">${pointsNeeded}</span> points √ó ‚Çπ<span class="document-highlight">${formatNumber(perPointCost)}</span>) ` +
                `is required to restore your score to the mandatory threshold of <span class="document-highlight">${minScore}</span> points.`;
        }

        // Email editing functionality
        document.getElementById('user-email').addEventListener('click', function() {
            document.getElementById('email-edit').classList.remove('hidden');
            document.getElementById('user-email').classList.add('hidden');
            document.getElementById('email-input').value = document.getElementById('user-email').textContent;
        });

        function saveEmail() {
            const newEmail = document.getElementById('email-input').value;
            document.getElementById('user-email').textContent = newEmail;
            document.getElementById('display-email').textContent = newEmail;
            document.getElementById('document-email').textContent = newEmail;
            document.getElementById('email-edit').classList.add('hidden');
            document.getElementById('user-email').classList.remove('hidden');
            
            // Show notification
            const notification = document.getElementById('notification');
            notification.textContent = "Email updated successfully!";
            notification.style.display = 'block';
            setTimeout(() => {
                notification.style.display = 'none';
            }, 2000);
        }

        function cancelEdit() {
            document.getElementById('email-edit').classList.add('hidden');
            document.getElementById('user-email').classList.remove('hidden');
        }

        // Screenshot functions
        async function captureMain() {
            try {
                const element = document.querySelector('.container');
                await captureElement(element, 'Main Container');
            } catch (err) {
                console.error('Capture failed:', err);
                showToast('‚ùå Failed to capture');
            }
        }

        async function captureDocument() {
            try {
                const element = document.getElementById('a4-document');
                await captureElement(element, 'Document');
            } catch (err) {
                console.error('Document capture failed:', err);
                showToast('‚ùå Failed to capture document');
            }
        }

        async function captureElement(element, sectionName = '') {
            try {
                const canvas = await html2canvas(element, {
                    backgroundColor: "#ffffff",     // Force white background
                    useCORS: true,                   // Allow images/fonts to load
                    allowTaint: false,              // Prevent tainted canvas
                    scale: 2                         // Optional: makes high-res
                });

                canvas.toBlob(async (blob) => {
                    try {
                        await navigator.clipboard.write([
                            new ClipboardItem({ 'image/png': blob })
                        ]);
                        showToast(`üìã ${sectionName} copied to clipboard!`);
                    } catch (err) {
                        saveAsImage(canvas, sectionName);
                    }
                }, 'image/png');
            } catch (err) {
                console.error('Capture error:', err);
                showToast(`‚ùå Failed to capture ${sectionName}`);
            }
        }



        function saveAsImage(canvas, name) {
            const link = document.createElement('a');
            link.download = `${name || 'screenshot'}.png`;
            link.href = canvas.toDataURL();
            link.click();
        }

        function showToast(message) {
            const toast = document.getElementById('notification');
            toast.textContent = message;
            toast.style.display = 'block';
            setTimeout(() => {
                toast.style.display = 'none';
            }, 3000);
        }

        // Initialize on load
        document.addEventListener('DOMContentLoaded', function() {
            // Set up event listeners
            document.getElementById('calculate-btn').addEventListener('click', updateAllValues);
            
            // Initialize timestamp
            function updateTimestamp() {
                const now = new Date();
                const timeStr = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit', hour12: false });
                const dateStr = now.toLocaleDateString();
                document.getElementById('timestamp').textContent = `${timeStr} ${dateStr}`;
            }
            updateTimestamp();
            setInterval(updateTimestamp, 60000);
            
            // Calculate initial values
            updateAllValues();
        });

        // Add these new functions to your existing script section

        // Update the document with calculated values
        function updateDocumentValues(originalScore, currentScore, perPointCost) {
            const pointsNeeded = originalScore - currentScore;
            const totalPayment = pointsNeeded * perPointCost;
            const totalWithdrawable = totalPayment + 350400; // Assuming 350,400 is a fixed base amount
            
            // Update calculator section
            document.getElementById('document-per-point').textContent = formatNumber(perPointCost);
            document.getElementById('document-points-to-restore').textContent = pointsNeeded;
            document.getElementById('document-per-point-value').textContent = formatNumber(perPointCost);
            document.getElementById('document-total-payment').textContent = formatNumber(totalPayment);
            
            // Update agreement section
            document.getElementById('document-current-score').textContent = currentScore;
            document.getElementById('document-point-value').textContent = formatNumber(perPointCost);
            document.getElementById('document-required-deposit').textContent = formatNumber(totalPayment);
            document.getElementById('document-points-needed').textContent = pointsNeeded;
            document.getElementById('document-deposit-amount').textContent = formatNumber(totalPayment);
            document.getElementById('document-total-withdrawable').textContent = formatNumber(totalWithdrawable);
        }

        // Event listeners
        document.getElementById('calculate-btn').addEventListener('click', calculateValues);
        document.getElementById('save-email').addEventListener('click', saveEmail)
        
        // Modified calculate function to update both main display and document
        document.getElementById('calculate-btn').addEventListener('click', function() {
            const originalScore = parseInt(document.getElementById('original-score').value);
            const currentScore = parseInt(document.getElementById('current-score-input').value);
            const perPointCost = parseInt(document.getElementById('per-point-cost').value);
            
            if (isNaN(originalScore) || isNaN(currentScore) || isNaN(perPointCost)) {
                alert('Please enter valid numbers for all fields');
                return;
            }
            
            if (currentScore > originalScore) {
                alert('Current score cannot be higher than original score');
                return;
            }
            
            const pointsLost = originalScore - currentScore;
            const totalPayment = pointsLost * perPointCost;
            
            // Update the main calculation result box
            document.getElementById('calculated-points').textContent = pointsLost;
            document.getElementById('calculated-per-point').textContent = formatNumber(perPointCost);
            document.getElementById('calculated-total').textContent = formatNumber(totalPayment);
            document.getElementById('calculation-result').classList.remove('hidden');
            
            // Update the main alert message
            document.getElementById('current-score').textContent = currentScore;
            document.getElementById('points-lost').textContent = pointsLost;
            document.getElementById('per-point-value').textContent = formatNumber(perPointCost);
            document.getElementById('payment-amount').textContent = formatNumber(totalPayment);
            document.getElementById('payment-amount-2').textContent = formatNumber(totalPayment);
            
            // Update the document with the same values
            updateDocumentValues(originalScore, currentScore, perPointCost);
        });
        
        // Modified saveEmail function to update all email displays
        // Save email and update document
        function saveEmail() {
            const email = document.getElementById('user-email').value;
            document.getElementById('agreement-email').textContent = email;
            
            // Show notification
            const notification = document.getElementById('notification');
            notification.style.display = 'block';
            setTimeout(() => {
                notification.style.display = 'none';
            }, 2000);
        }
        
        // Function to update the email in the document when the main email changes
        function updateDocumentEmail(newEmail) {
            document.getElementById('document-email').textContent = newEmail;
        }
        
        // Modified saveEmail function to also update the document email
        function saveEmail() {
            const newEmail = document.getElementById('email-input').value;
            document.getElementById('user-email').textContent = newEmail;
            document.getElementById('display-email').textContent = newEmail;
            updateDocumentEmail(newEmail); // Update the document email too
            document.getElementById('email-edit').classList.add('hidden');
            document.getElementById('user-email').classList.remove('hidden');
        }
        
        // Dedicated capture function for the document
        async function captureDocument() {
            try {
                const element = document.getElementById('a4-document');
                await captureElement(element, 'Document');
            } catch (err) {
                console.error('Document capture failed:', err);
                showToast('‚ùå Failed to capture document');
            }
        }
        
        // Initialize the document with the current email
        document.addEventListener('DOMContentLoaded', function() {
            const initialEmail = document.getElementById('user-email').textContent;
            updateDocumentEmail(initialEmail);
            calculateValues();
        });
    </script>
</body>
</html>
